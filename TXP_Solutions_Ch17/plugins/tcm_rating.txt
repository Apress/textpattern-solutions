# tcm_rating v0.6b
# A Textpattern rating system.
# WorkingIdea
# http://workingidea.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YTo5OntzOjQ6Im5hbWUiO3M6MTA6InRjbV9yYXRpbmciO3M6NzoidmVyc2lvbiI7czo0OiIw
LjZiIjtzOjY6ImF1dGhvciI7czoxMToiV29ya2luZ0lkZWEiO3M6MTA6ImF1dGhvcl91cmki
O3M6MjM6Imh0dHA6Ly93b3JraW5naWRlYS5jb20vIjtzOjExOiJkZXNjcmlwdGlvbiI7czoy
ODoiQSBUZXh0cGF0dGVybiByYXRpbmcgc3lzdGVtLiI7czo0OiJ0eXBlIjtpOjE7czo0OiJo
ZWxwIjtzOjE3Njg6Igk8cD4KPGNvZGU+dGNtX3JhdGluZzwvY29kZT4gaXMgYSBjb21wbGV4
IGFuZCBjb21wbGV0ZSByYXRpbmcgc3lzdGVtIGZvciA8YSBocmVmPSJodHRwOi8vd3d3LnRl
eHRwYXR0ZXJuLmNvbS8iPlRleHRwYXR0ZXJuPC9hPi48L3A+Cgk8aDQ+UmVxdWlyZW1lbnRz
PC9oND4KCTx1bD4KCQk8bGk+VGV4dHBhdHRlcm4gNC4wMzwvbGk+Cgk8L3VsPgoJPGg0Pklu
c3RhbGxhdGlvbjwvaDQ+Cgk8dWw+CgkJPGxpPlZpZXdpbmcgdGhlIHRhYiB1bmRlciAmIzgy
MjA7ZXh0ZW5zaW9ucyYjODIyMTsgd2lsbCBhdXRvbWF0aWNhbGx5IGluc3RhbGwgdGhlIGRh
dGFiYXNlIHRhYmxlcyByZXF1aXJlZCBmb3IgdGhlIHBsdWdpbi48L2xpPgoJCTxsaT5UaGUg
JiM4MjIwO0luc3RhbGwgYW5kIEFkbWluJiM4MjIxOyBzZWN0aW9uIG9mIHRoZSBwbHVnaW4g
d2lsbCBhbGxvdyB5b3UgdG8gYXBwZW5kIENTUyB0byBhIHN0eWxlc2hlZXQgb3IgdmlldyB0
aGUgQ1NTIGZvciBleHRlcm5hbCBzdHlsZXMuPC9saT4KCQk8bGk+SXQgY2FuIGFsc28gdW5p
bnN0YWxsIHRoZSBEQiB0YWJsZXMuIFRoaXMgd2lsbCBiZSBhIGxpdHRsZSBtb3JlIGVsZWdh
bnQgaW4gdGhlIGZ1dHVyZSwgYnV0IGl0JiM4MjE3O3Mgc2FmZSBmb3Igbm93LjwvbGk+Cgk8
L3VsPgoJPGg0PlB1YmxpYyB0YWdzPC9oND4KCTx1bD4KCQk8bGk+ICYjODIxMTsgb3V0cHV0
IHRoZSBudW1iZXIgb2YgcmF0aW5ncyBzdWJtaXR0ZWQgZm9yIGFuIGFydGljbGUuCgk8dWw+
CgkJPGxpPk9wdGlvbnM8L2xpPgoJCTxsaT5ub3JhdGluZ3M9JiM4MjIxO1RleHQgdG8gc2hv
dyBpZiBzb21ldGhpbmcgaGFzbiYjODIxNzt0IGJlZW4gcmF0ZWQmIzgyMjE7PC9saT4KCQk8
bGk+aGFzYmVlbj0mIzgyMjE7VGV4dCB0byBzaG93IHdoZW4gc29tZXRoaW5nIGhhcyBiZWVu
IHJhdGVkLiYjODIyMTsKCTx1bD4KCQk8bGk+Rm9ybWF0OiAlciA9IG51bWJlciBvZiByYXRp
bmdzPC9saT4KCQk8bGk+KHNpbmd1bGFyIHdvcmRzL3BsdXJhbCB3b3Jkcyk8L2xpPgoJCTxs
aT5FeGFtcGxlOiA8Y29kZT5UaGlzIGhhcyBiZWVuIHJhdGVkICVyICh0aW1lL3RpbWVzKTwv
Y29kZT48L2xpPgoJPC91bD48L2xpPgoJCTxsaT5hbHBoYT0mIzgyMjE7dHJ1ZSYjODIyMTsg
aWYgeW91IHdhbnQgdG8gdXNlIG51bWJlciB3b3JkcyAoZS5nLiAmIzgyMjA7b25lJiM4MjIx
OyBpbnN0ZWFkIG9mICYjODIyMDsxJiM4MjIxOyk8L2xpPgoJPC91bD48L2xpPgoJCTxsaT4g
JiM4MjExOyBjbG9uZSBvZiA8Y29kZT5kb0FydGljbGVzPC9jb2RlPiBidXQgc29ydHMgYXJ0
aWNsZXMgYnkgYXZlcmFnZSByYXRpbmcgcmF0aGVyIHRoYW4gcG9zdGVkIHRpbWUuPC9saT4K
CQk8bGk+ICYjODIxMTsgdGhlIGlucHV0IGFuZCBvdXRwdXQgcGx1Z2luIGZvciB0Y21fcmF0
aW5nPC9saT4KCTwvdWw+Cgk8aDQ+Q3JlZGl0PC9oND4KCTx1bD4KCQk8bGk+VGhpcyBwbHVn
aW4gdXNlcyA8Y29kZT5handfY2xlYW5fZmVlZF9jaG9wPC9jb2RlPiBhbmQgPGNvZGU+YWp3
X2NsZWFuX2ZlZWRfcmVxdWVzdDwvY29kZT4gZnJvbSA8YSBocmVmPSJodHRwOi8vY29tcG9v
dGVyLm9yZy8iPkNvbXBvb3Rlci5vcmc8L2E+PC9saT4KCTwvdWw+Cgk8aDQ+Tm90ZXM8L2g0
PgoJPHVsPgoJCTxsaT5UaGlzIHBsdWdpbiBjcmVhdGVzIGFuIEFKQVggKGFjdHVhbGx5IEFI
QUgpIGVuZHBvaW50IGF0IHVybHMgYmVnaW5uaW5nIHdpdGggL3JhdGUvLiBJZiB5b3UgaGF2
ZSBzb21ldGhpbmcgdGhlcmUsIGl0IG1pZ2h0IGNvbmZsaWN0LjwvbGk+Cgk8L3VsPgoKCiAi
O3M6NDoiY29kZSI7czoyODgxMDoiCmlmIChAdHhwaW50ZXJmYWNlID09ICdwdWJsaWMnKSB7
CiAgICByZWdpc3Rlcl9jYWxsYmFjaygidGNtX3JhdGluZ19wdCIsICdwcmV0ZXh0Jyk7CiAg
ICByZWdpc3Rlcl9jYWxsYmFjaygidGNtX3JhdGluZ19qcyIsICdwcmV0ZXh0Jyk7Cn0KCmlm
IChAdHhwaW50ZXJmYWNlID09ICdhZG1pbicpIHsKICAgICRteWV2ZW50ID0gJ3JhdGluZyc7
CiAgICAkbXl0YWIgPSAncmF0aW5ncyc7CiAgICBhZGRfcHJpdnMoJG15ZXZlbnQsICcxLDIs
Myw0LDUnKTsKICAgIHJlZ2lzdGVyX3RhYigiZXh0ZW5zaW9ucyIsICRteWV2ZW50LCAkbXl0
YWIpOwogICAgcmVnaXN0ZXJfY2FsbGJhY2soInRjbV9yYXRpbmdfYWRtaW4iLCAkbXlldmVu
dCk7Cn0KZnVuY3Rpb24gdGNtX3JhdGluZ19hZG1pbigkZXZlbnQsICRzdGVwKQp7CiAgICBp
ZiAoISRzdGVwIG9yICFpbl9hcnJheSgkc3RlcCwgYXJyYXkoJ3RjbV9yYXRpbmdfaW5zdGFs
bF9kYicsICd0Y21fcmF0aW5nX3VuaW5zdGFsbF9kYicsICd0Y21fcmF0aW5nX2luc3RhbGxf
Zm9ybScsICdzaG93Y3NzJywgJ2FwcGVuZF9jc3MnKSkpIHsKICAgICAgICBsaXN0X3F1ZXVl
KCk7CiAgICB9IGVsc2UgJHN0ZXAoKTsKfQoKZnVuY3Rpb24gdGNtX3JhdGluZ19pbnN0YWxs
X2Zvcm0oJG1lc3NhZ2UgPSAnJykKewogICAgdGNtX3JhdGluZ19pbnN0YWxsX2RiKCk7CiAg
ICBwYWdldG9wKCJSYXRpbmcgQWRtaW4iKTsKICAgIGVjaG8gIjxkaXYgYWxpZ249XCJjZW50
ZXJcIiBzdHlsZT1cIm1hcmdpbi10b3A6M2VtXCI+IiAuIHNMaW5rKCdyYXRpbmcnLCAnbGlz
dF9xdWV1ZScsICdMaXN0JywgJ25hdmxpbmsnKSAuICI8L2Rpdj4iOwogICAgZWNobyAiPGRp
diBhbGlnbj1cImNlbnRlclwiIHN0eWxlPVwibWFyZ2luLXRvcDozZW1cIj4iOwogICAgZWNo
byBmb3JtKAogICAgICAgIHRhZygiU1FMIiwgImgzIikgLgogICAgICAgIGdyYWYoIkRyb3Ag
REIgVGFibGVzOiAiIC4KICAgICAgICAgICAgZklucHV0KCJzdWJtaXQiLCAidW5pbnN0YWxs
IiwgIlVuaW5zdGFsbCIsICJwdWJsaXNoIikgLgogICAgICAgICAgICBlSW5wdXQoInJhdGlu
ZyIpIC4gc0lucHV0KCJ0Y21fcmF0aW5nX3VuaW5zdGFsbF9kYiIpICwgIiBzdHlsZT1cInRl
eHQtYWxpZ246Y2VudGVyXCIiKSk7CiAgICBlY2hvICI8L2Rpdj4iOwoKICAgICRzdHlsZXNs
aXN0ID0gc2FmZV9jb2x1bW4oIm5hbWUiLCAidHhwX2NzcyIsICIxPTEiKTsKICAgIGVjaG8g
IjxkaXYgYWxpZ249XCJjZW50ZXJcIiBzdHlsZT1cIm1hcmdpbi10b3A6M2VtXCI+IjsKICAg
IGVjaG8gZm9ybSgKICAgICAgICB0YWcoIkNTUyIsICJoMyIpIC4KICAgICAgICBncmFmKCJB
cHBlbmQgQ1NTIHRvICIgLiBzZWxlY3RJbnB1dCgnY3NzJywgJHN0eWxlc2xpc3QpIC5ici4K
CQkJCSJJbWFnZSBQYXRoOiAiLiBmSW5wdXQoJ3RleHQnLCdpbWFnZV9wYXRoJywnJywnZWRp
dCcpLmJyLgogICAgICAgICAgICBmSW5wdXQoInN1Ym1pdCIsICJhcHBlbmQiLCAiQXBwZW5k
IiwgInB1Ymxpc2giKSAuCiAgICAgICAgICAgICc8YSB0YXJnZXQ9Il9ibGFuayIgaHJlZj0i
P2V2ZW50PXJhdGluZyZzdGVwPXNob3djc3MiCiAgICAgICAgICAgIG9uY2xpY2s9IndpbmRv
dy5vcGVuKHRoaXMuaHJlZiwgXCdwb3B1cHdpbmRvd1wnLFwnd2lkdGg9NjAwLCBoZWlnaHQ9
NjAwLHNjcm9sbGJhcnMscmVzaXphYmxlXCcpOyByZXR1cm4gZmFsc2U7Ij5WaWV3IENTUzwv
YT4nCiAgICAgICAgICAgIC4gZUlucHV0KCJyYXRpbmciKSAuIHNJbnB1dCgiYXBwZW5kX2Nz
cyIpICwgIiBzdHlsZT1cInRleHQtYWxpZ246Y2VudGVyXCIiKQogICAgICAgICAgICApOwog
ICAgZWNobyAiPC9kaXY+IjsKfQoKZnVuY3Rpb24gYXBwZW5kX2NzcygpCnsKICAgICRuYW1l
ID0gZ3BzKCdjc3MnKTsKICAgICRpbWFnZV9wYXRoID0gZ3BzKCdpbWFnZV9wYXRoJyk7CiAg
ICAkdGhlY3NzID0gYmFzZTY0X2RlY29kZShmZXRjaCgiY3NzIiwgJ3R4cF9jc3MnLCAnbmFt
ZScsICRuYW1lKSk7CiAgICAkYXBwZW5kX2NzcyA9IHJldHVybl9jc3MoJGltYWdlX3BhdGgp
OwogICAgJG5ld2NzcyA9IGJhc2U2NF9lbmNvZGUoJHRoZWNzcyAuICRhcHBlbmRfY3NzKTsK
ICAgICRycyA9IHNhZmVfdXBkYXRlKCJ0eHBfY3NzIiwgImNzcyA9ICciIC4gJG5ld2NzcyAu
ICInIiwgIm5hbWUgPSAnJG5hbWUnIik7CiAgICBpZiAoJHJzKSB7CiAgICAgICAgdGNtX3Jh
dGluZ19pbnN0YWxsX2Zvcm0oIkNTUyBBcHBlbmQgc3VjY2Vzc2Z1bCIpOwogICAgfSBlbHNl
IHsKICAgICAgICB0Y21fcmF0aW5nX2luc3RhbGxfZm9ybSgiQ1NTIEFwcGVuZCBmYWlsZWQi
KTsKICAgIH0KfQoKZnVuY3Rpb24gc2hvd2NzcygpCnsKICAgICRpbWFnZV9wYXRoID0gKGdw
cygnaW1hZ2VfcGF0aCcpKSA/IGdwcygnaW1hZ2VfcGF0aCcpIDogIiI7CiAgICBlY2hvIDw8
PCBIRUFEU0VDVElPTgo8IURPQ1RZUEUgaHRtbCBQVUJMSUMgIi0vL1czQy8vRFREIFhIVE1M
IDEuMCBUcmFuc2l0aW9uYWwvL0VOIgoiaHR0cDovL3d3dy53My5vcmcvVFIveGh0bWwxL0RU
RC94aHRtbDEtdHJhbnNpdGlvbmFsLmR0ZCI+CjxodG1sIHhtbG5zPSJodHRwOi8vd3d3Lncz
Lm9yZy8xOTk5L3hodG1sIiB4bWw6bGFuZz0iZW4iIGxhbmc9ImVuIj4KPGhlYWQ+CjxtZXRh
IGh0dHAtZXF1aXY9ImNvbnRlbnQtdHlwZSIgY29udGVudD0idGV4dC9odG1sOyBjaGFyc2V0
PXV0Zi04IiAvPgo8dGl0bGU+VGV4dHBhdHRlcm46IFJhdGluZyBDU1MgVmlldzwvdGl0bGU+
CjwvaGVhZD4KPGJvZHk+CkhFQURTRUNUSU9OOwogICAgZWNobyBmb3JtKAoJCSAgICAiSW1h
Z2UgUGF0aDogIi4gZklucHV0KCd0ZXh0JywnaW1hZ2VfcGF0aCcsJycsJ2VkaXQnKS4KICAg
ICAgICAgICAgZklucHV0KCJzdWJtaXQiLCAic2hvd2NzcyIsICJTaG93IENTUyIsICJwdWJs
aXNoIikKICAgICAgICAgICAgLiBlSW5wdXQoInJhdGluZyIpIC4gc0lucHV0KCJzaG93Y3Nz
IikgLCAiIHN0eWxlPVwidGV4dC1hbGlnbjpjZW50ZXJcIiIpOwogICAgZWNobyB0Y21fdGV4
dGFyZWEoJzUwMCcsICc1NTAnLCBodG1sZW50aXRpZXMocmV0dXJuX2NzcygkaW1hZ2VfcGF0
aCkpLCAnY3NzJyk7CiAgICBleGl0Owp9CmZ1bmN0aW9uIHRjbV90ZXh0YXJlYSgkaCwgJHcs
ICRjb250ZW50LCAkbmFtZSkKewogICAgcmV0dXJuICc8dGV4dGFyZWEgbmFtZT0iJyAuICRu
YW1lIC4gJyIgc3R5bGU9ImhlaWdodDonIC4gJGggLiAncHg7d2lkdGg6JyAuICR3IC4gJ3B4
O2ZvbnQtZmFtaWx5Om1vbmFjbyxjb3VyaWVyLGNvdXJpZXIgbmV3O2ZvbnQtc2l6ZToxMHB4
O21hcmdpbi10b3A6NnB4IiByb3dzPSIxIiBjb2xzPSIxIj4nIC4gaHRtbHNwZWNpYWxjaGFy
cygkY29udGVudCkgLiAnPC90ZXh0YXJlYT4nOwp9CgpmdW5jdGlvbiB0Y21fcmF0aW5nX2lu
c3RhbGxfZGIoKQp7CiAgICAkc3FsID0gIkNSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIGAi
IC4gUEZYIC4gInR4cF90Y21fcnF1ZXVlYCAoCiAgYHBhcmVudF9pZGAgaW50KDExKSBOT1Qg
TlVMTCBkZWZhdWx0ICcwJywKICBgaWRgIGludCgxMSkgTk9UIE5VTEwgYXV0b19pbmNyZW1l
bnQsCiAgYGlwYCB2YXJjaGFyKDMwKSBOT1QgTlVMTCBkZWZhdWx0ICcnLAogIGByYXRpbmdg
IGludCgxMSkgTk9UIE5VTEwgZGVmYXVsdCAnMCcsCiAgYHBvc3RlZGAgZGF0ZXRpbWUgTk9U
IE5VTEwgZGVmYXVsdCAnMDAwMC0wMC0wMCAwMDowMDowMCcsCiAgUFJJTUFSWSBLRVkgIChg
aWRgKSwKICBLRVkgYGlwYCAoYGlwYCksCiAgS0VZIGBwb3N0ZWRgIChgcG9zdGVkYCkKKSBF
TkdJTkU9TXlJU0FNIERFRkFVTFQgQ0hBUlNFVD1sYXRpbjE7IjsKICAgICRycyA9IHNhZmVf
cXVlcnkoJHNxbCk7CiAgICAkc3FsMiA9ICJDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBg
IiAuIFBGWCAuICJ0eHBfdGNtX3JzdW1gICgKICBgaWRgIGludCgxMCkgTk9UIE5VTEwgYXV0
b19pbmNyZW1lbnQsCiAgYHBhcmVudF9pZGAgaW50KDEwKSB1bnNpZ25lZCBOT1QgTlVMTCBk
ZWZhdWx0ICcwJywKICBgcmF0aW5nc2AgaW50KDExKSBOT1QgTlVMTCBkZWZhdWx0ICcwJywK
ICBgc3VtYCBpbnQoMTEpIE5PVCBOVUxMIGRlZmF1bHQgJzAnLAogIGBhdmVyYWdlYCBmbG9h
dCBOT1QgTlVMTCBkZWZhdWx0ICcwJywKICBQUklNQVJZIEtFWSAgKGBpZGApLAogIEtFWSBg
cGFyZW50X2lkYCAoYHBhcmVudF9pZGApCikgRU5HSU5FPU15SVNBTSBERUZBVUxUIENIQVJT
RVQ9bGF0aW4xOyI7CiAgICAkcnMyID0gc2FmZV9xdWVyeSgkc3FsMik7CiAgICBpZiAoJHJz
ICYmICRyczIpIHsKICAgICAgICAvL2VjaG8gcGFnZXRvcCgiSW5zdGFsbCBSYXRpbmcgU3lz
dGVtIiwgImluc3RhbGxhdGlvbiBzdWNjZXNzZnVsIik7CiAgICAgICAgc2FmZV9kZWxldGUo
InR4cF90Y21fcnF1ZXVlIiwgInBvc3RlZCA8IGRhdGVfc3ViKG5vdygpLGludGVydmFsIDEg
ZGF5KSIpOwogICAgfSBlbHNlIHsKICAgICAgICAvL2VjaG8gcGFnZXRvcCgiSW5zdGFsbCBS
YXRpbmcgU3lzdGVtIiwgImluc3RhbGxhdGlvbiBmYWlsZWQiKTsKICAgIH0KfQoKZnVuY3Rp
b24gdGNtX3JhdGluZ191bmluc3RhbGxfZGIoKQp7CiAgICAkcnMgPSBzYWZlX3F1ZXJ5KCJE
Uk9QIFRBQkxFIElGIEVYSVNUUyBgdHhwX3RjbV9ycXVldWVgOyIpOwogICAgJHJzMiA9IHNh
ZmVfcXVlcnkoIkRST1AgVEFCTEUgSUYgRVhJU1RTIGB0eHBfdGNtX3JzdW1gOyIpOwogICAg
aWYgKCRycyAmJiAkcnMyKSB7CiAgICAgICAgdGNtX3JhdGluZ19pbnN0YWxsX2Zvcm0oInVu
aW5zdGFsbGF0aW9uIHN1Y2Nlc3NmdWwiKTsKICAgIH0gZWxzZSB7CiAgICAgICAgdGNtX3Jh
dGluZ19pbnN0YWxsX2Zvcm0oInVuaW5zdGFsbGF0aW9uIGZhaWxlZCIpOwogICAgfQp9Cgpm
dW5jdGlvbiBsaXN0X3F1ZXVlKCRtZXNzYWdlID0gJycpCnsKICAgICAgICB0Y21fcmF0aW5n
X2luc3RhbGxfZGIoKTsKICAgICAgICBpZiAoaXNzZXQoJG1lc3NhZ2UpKSB7CiAgICAgICAg
ICAgIHBhZ2V0b3AoIlZpZXcgUmF0aW5nIFF1ZXVlIiwgJG1lc3NhZ2UpOwogICAgICAgIH0g
ZWxzZSB7CiAgICAgICAgICAgIHBhZ2V0b3AoIlZpZXcgUmF0aW5nIFF1ZXVlIik7CiAgICAg
ICAgfQogICAgICAgICRwYWdlID0gZ3BzKCdwYWdlJyk7CiAgICAgICAgJHRvdGFsID0gZ2V0
Q291bnQoJ3R4cF90Y21fcnF1ZXVlJywgIjEiKTsKICAgICAgICAkbGltaXQgPSA0MDsKICAg
ICAgICAkbnVtUGFnZXMgPSBjZWlsKCR0b3RhbCAvICRsaW1pdCk7CiAgICAgICAgJHBhZ2Ug
PSAoISRwYWdlKSA/IDEgOiAkcGFnZTsKICAgICAgICAkb2Zmc2V0ID0gKCRwYWdlIC0gMSkg
KiAkbGltaXQ7CiAgICAgICAgJG5hdltdID0gKCRwYWdlID4gMSkKICAgICAgICA/IFByZXZO
ZXh0TGluaygicmF0aW5nIiwgJHBhZ2UtMSwgZ1R4dCgncHJldicpLCAncHJldicpIDogJyc7
CgogICAgICAgICRuYXZbXSA9IHNwIC4gc21hbGwoJHBhZ2UgLiAnLycgLiAkbnVtUGFnZXMp
IC4gc3A7CgogICAgICAgICRuYXZbXSA9ICgkcGFnZSAhPSAkbnVtUGFnZXMpCiAgICAgICAg
PyBQcmV2TmV4dExpbmsoInJhdGluZyIsICRwYWdlICsgMSwgZ1R4dCgnbmV4dCcpLCAnbmV4
dCcpIDogJyc7Ci8qCiAgICAgICAgJHJzID0gc2FmZV9yb3dzX3N0YXJ0KCIqLCB1bml4X3Rp
bWVzdGFtcChwb3N0ZWQpIGFzIHN0YW1wIiwKICAgICAgICAgICAgInR4cF90Y21fcnF1ZXVl
IiwKICAgICAgICAgICAgIjEgb3JkZXIgYnkgcG9zdGVkIGRlc2MgbGltaXQgJG9mZnNldCwg
JGxpbWl0IgogICAgICAgICAgICApOwogICAgICAgICAgICAqLwogICAgICAgICAkcnMgPSBz
YWZlX3Jvd3Nfc3RhcnRfam9pbmVkKCIqLCB1bml4X3RpbWVzdGFtcCgiLlBGWC4idHhwX3Rj
bV9ycXVldWUucG9zdGVkKSBhcyBzdGFtcCIsIEFycmF5KCd0ZXh0cGF0dGVybicsICd0eHBf
dGNtX3JxdWV1ZScpLAogICAgICAgICBQRlguInR4cF90Y21fcnF1ZXVlLnBhcmVudF9pZCA9
ICIuUEZYLiJ0ZXh0cGF0dGVybi5JRCAiLicgb3JkZXIgYnkgJy5QRlguInR4cF90Y21fcnF1
ZXVlLnBvc3RlZCBkZXNjIGxpbWl0ICRvZmZzZXQsICRsaW1pdCIpOwogICAgICAgIGlmICgk
cnMpIHsKICAgICAgICAgICAgZWNobyB0YWcoIlJhdGluZyBRdWV1ZSIsICJoMyIsICIgc3R5
bGU9J3RleHQtYWxpZ246IGNlbnRlciciKTsKICAgICAgICAgICAgZWNobyBzdGFydFRhYmxl
KCdsaXN0JyksCiAgICAgICAgICAgIGFzc0hlYWQoJ3RpbWUnLCAnaG9zdCcsICdhcnRpY2xl
JywgJ3JhdGluZycpLAogICAgICAgICAgICB0cih0ZGNzKHNMaW5rKCdyYXRpbmcnLCAndGNt
X3JhdGluZ19pbnN0YWxsX2Zvcm0nLCAnSW5zdGFsbCAmYW1wOyBBZG1pbicsICduYXZsaW5r
JyksICc0JykpOwogICAgICAgICAgICB3aGlsZSAoJGEgPSBuZXh0Um93KCRycykpIHsKICAg
ICAgICAgICAgICAgIGV4dHJhY3QoJGEpOwogICAgICAgICAgICAgICAgJGZzdGFtcCA9IGRh
dGUoIm4vaiBnOmkgYSIsICgkc3RhbXAgKyB0el9vZmZzZXQoKSkpOwogICAgICAgICAgICAg
ICAgLy8KICAgICAgICAgICAgICAgIGVjaG8gdHIoCiAgICAgICAgICAgICAgICAgICAgdGQo
JGZzdGFtcCkgLgogICAgICAgICAgICAgICAgICAgIHRkKHRhZygkaXAsICdhJywgJyBocmVm
PSJodHRwOi8vd3d3LmRuc3N0dWZmLmNvbS90b29scy9jaXR5LmNoP2lwPScuJGlwLiciICcp
KSAuCiAgICAgICAgICAgICAgICAgICAgdGQodGFnKCRUaXRsZSwgJ2EnLCAnIGhyZWY9Iicu
dGNtX3Blcm1saW5rdXJsKCRhKS4nIicpKSAuCiAgICAgICAgICAgICAgICAgICAgdGQocmF0
aW5nX2RvdHMoJHJhdGluZykpKTsKICAgICAgICAgICAgICAgIHVuc2V0KCRmc3RhbXAsICRp
cCwgJHBhcmVudF9pZCwgJHJhdGluZyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWNo
byAnPHRyPjx0ZCBjb2xzcGFuPSI0IiBhbGlnbj0icmlnaHQiIHN0eWxlPSJwYWRkaW5nOjEw
cHgiPicsCiAgICAgICAgICAgIGpvaW4oJycsICRuYXYpLAogICAgICAgICAgICAiPC90ZD48
L3RyPiI7CiAgICAgICAgICAgIGVjaG8gZW5kVGFibGUoKTsKICAgICAgICB9Cn0KCgovLyAt
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tCglmdW5jdGlvbiB0Y21fcGVybWxpbmt1cmwoJGFydGljbGVfYXJyYXkpCgl7CgkJ
Z2xvYmFsICRwZXJtbGlua19tb2RlLCAkcHJlZnM7CgoJCWlmIChpc3NldCgkcHJlZnNbJ2N1
c3RvbV91cmxfZnVuYyddKSBhbmQgaXNfY2FsbGFibGUoJHByZWZzWydjdXN0b21fdXJsX2Z1
bmMnXSkpCgkJCXJldHVybiBjYWxsX3VzZXJfZnVuYygkcHJlZnNbJ2N1c3RvbV91cmxfZnVu
YyddLCAkYXJ0aWNsZV9hcnJheSk7CgoJCWlmIChlbXB0eSgkYXJ0aWNsZV9hcnJheSkpIHJl
dHVybjsKCgkJZXh0cmFjdCgkYXJ0aWNsZV9hcnJheSk7CgoJCWlmICghaXNzZXQoJHRpdGxl
KSkgJHRpdGxlID0gJFRpdGxlOwoJCWlmIChlbXB0eSgkdXJsX3RpdGxlKSkgJHVybF90aXRs
ZSA9IHN0cmlwU3BhY2UoJHRpdGxlKTsKCQlpZiAoZW1wdHkoJHNlY3Rpb24pKSAkc2VjdGlv
biA9ICRTZWN0aW9uOyAvLyBsYW1lLCBodWg/CgkJaWYgKGVtcHR5KCRwb3N0ZWQpKSAkcG9z
dGVkID0gJFBvc3RlZDsKCQlpZiAoZW1wdHkoJHRoaXNpZCkpICR0aGlzaWQgPSAkSUQ7CgoJ
CXN3aXRjaCgkcGVybWxpbmtfbW9kZSkgewoJCQljYXNlICdzZWN0aW9uX2lkX3RpdGxlJzoK
CQkJCWlmICgkcHJlZnNbJ2F0dGFjaF90aXRsZXNfdG9fcGVybWFsaW5rcyddKQoJCQkJewoJ
CQkJCXJldHVybiBodS4iJHNlY3Rpb24vJHRoaXNpZC8kdXJsX3RpdGxlIjsKCQkJCX1lbHNl
ewoJCQkJCXJldHVybiBodS4iJHNlY3Rpb24vJHRoaXNpZC8iOwoJCQkJfQoJCQljYXNlICd5
ZWFyX21vbnRoX2RheV90aXRsZSc6CgkJCQlsaXN0KCR5LCRtLCRkKSA9IGV4cGxvZGUoIi0i
LGRhdGUoIlktbS1kIiwkcG9zdGVkKSk7CgkJCQlyZXR1cm4gaHUuIiR5LyRtLyRkLyR1cmxf
dGl0bGUiOwoJCQljYXNlICdpZF90aXRsZSc6CgkJCQlpZiAoJHByZWZzWydhdHRhY2hfdGl0
bGVzX3RvX3Blcm1hbGlua3MnXSkKCQkJCXsKCQkJCQlyZXR1cm4gaHUuIiR0aGlzaWQvJHVy
bF90aXRsZSI7CgkJCQl9ZWxzZXsKCQkJCQlyZXR1cm4gaHUuIiR0aGlzaWQvIjsKCQkJCX0K
CQkJY2FzZSAnc2VjdGlvbl90aXRsZSc6CgkJCQlyZXR1cm4gaHUuIiRzZWN0aW9uLyR1cmxf
dGl0bGUiOwoJCQljYXNlICd0aXRsZV9vbmx5JzoKCQkJCXJldHVybiBodS4iJHVybF90aXRs
ZSI7CgkJCWNhc2UgJ21lc3N5JzoKCQkJCXJldHVybiBodS4iaW5kZXgucGhwP2lkPSR0aGlz
aWQiOwoJCX0KCX0KCgpmdW5jdGlvbiByYXRpbmdfZG90cygkcmF0aW5nKQp7CiAgICRvdXQg
PSAiIjsKICAgZm9yKCRpID0gMDskaSA8ICRyYXRpbmc7JGkrKykKICAgewogICAgICAkb3V0
IC49ICImbWRhc2g7IjsKICAgfQogICByZXR1cm4gJG91dDsKfQoKZnVuY3Rpb24gdGNtX3Jh
dGluZ19qcygpCnsKICAgIGdsb2JhbCAkcHJlZnM7CiAgICBleHRyYWN0KCRwcmVmcyk7Cgog
ICAgJHBhZ2VbJ3JlcSddID0gdGNtX2NsZWFuX3JlcXVlc3QoKTsKICAgICRwYWdlWydwYXRo
J10gPSB0Y21fY2xlYW5fY2hvcChAJHBhZ2VbJ3JlcSddWzBdKTsKICAgIGlmICghZW1wdHko
JHBhZ2VbJ3BhdGgnXVswXSkpIHsKICAgICAgICBpZiAoJHBhZ2VbJ3BhdGgnXVswXSA9PSAn
cmF0aW5nanMnKSB7CiAgICAgICAgICAgZWNobyByZXR1cm5fanMoKTsKICAgICAgICAgICBk
aWU7CiAgICAgICAgfQogICAgfQp9CgpmdW5jdGlvbiB0Y21fcmF0aW5nX3B0KCkKewogICAg
Z2xvYmFsICRwcmVmczsKICAgIGV4dHJhY3QoJHByZWZzKTsKCiAgICAkcGFnZVsncmVxJ10g
PSB0Y21fY2xlYW5fcmVxdWVzdCgpOwogICAgJHBhZ2VbJ3BhdGgnXSA9IHRjbV9jbGVhbl9j
aG9wKEAkcGFnZVsncmVxJ11bMF0pOwogICAgaWYgKCFlbXB0eSgkcGFnZVsncGF0aCddWzBd
KSkgewogICAgICAgIGlmICgkcGFnZVsncGF0aCddWzBdID09ICdyYXRlJykgewogICAgICAg
ICAgICBpZiAoaXNfbnVtZXJpYygkcGFnZVsncGF0aCddWzFdKSkgewogICAgICAgICAgICAg
ICAgJGFydGljbGUgPSBzYWZlX3JvdygiKiIsICJ0ZXh0cGF0dGVybiIsICJJRD0nIiAuIGlu
dHZhbCgkcGFnZVsncGF0aCddWzFdKSAuICInIGFuZCBTdGF0dXMgaW4gKDQsNSkiKTsKICAg
ICAgICAgICAgICAgICRhaWQgPSAkcGFnZVsncGF0aCddWzFdOwogICAgICAgICAgICAgICAg
aWYgKCFlbXB0eSgkYXJ0aWNsZSkpIHsKICAgICAgICAgICAgICAgICAgICAvLyBOT1RFOiBj
aGVja2luZyByYXRpbmcKICAgICAgICAgICAgICAgICAgICBpZiAoaXNzZXQoJHBhZ2VbJ3Bh
dGgnXVsyXSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzX251bWVyaWMoJHBh
Z2VbJ3BhdGgnXVsyXSkgJiYgKCRwYWdlWydwYXRoJ11bMl0gPCA2KSAmJiAoJHBhZ2VbJ3Bh
dGgnXVsyXSA+IDApKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaXAgPSBzZXJ2
ZXJTZXQoJ1JFTU9URV9BRERSJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcHJl
Y2VkZW50ID0gc2FmZV9yb3dzKCIqIiwgInR4cF90Y21fcnF1ZXVlIiwgInBhcmVudF9pZD0i
IC4gaW50dmFsKCRwYWdlWydwYXRoJ11bMV0pIC4gIiBhbmQgaXA9JyIgLiAkaXAgLiAiJyBh
bmQgcG9zdGVkID4gZGF0ZV9zdWIobm93KCksaW50ZXJ2YWwgMSBkYXkpIik7CiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAvLyBwcmludF9yKCRwcmVjZWRlbnQpOwogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgaWYgKGVtcHR5KCRwcmVjZWRlbnQpKSB7CiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc2FmZV9pbnNlcnQoInR4cF90Y21fcnF1ZXVlIiwgInBh
cmVudF9pZD0nIiAuIGludHZhbCgkcGFnZVsncGF0aCddWzFdKSAuICInLCBpcD0nIiAuICRp
cCAuICInLCByYXRpbmc9IiAuICRwYWdlWydwYXRoJ11bMl0gLiAiLCBwb3N0ZWQ9bm93KCki
KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3VtX3ByZWNlZGVudCA9IHNh
ZmVfcm93KCJyYXRpbmdzLCBzdW0sIGF2ZXJhZ2UiLCAidHhwX3RjbV9yc3VtIiwgInBhcmVu
dF9pZD0nIiAuIGludHZhbCgkcGFnZVsncGF0aCddWzFdKSAuICInIik7CiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgJHJhdGluZ3MgPSAkc3VtID0gJGF2ZXJhZ2UgPSAwOwog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZW1wdHkoJHN1bV9wcmVjZWRl
bnQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyYXRpbmdzID0g
JHN1bV9wcmVjZWRlbnRbInJhdGluZ3MiXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgJHN1bSA9ICRzdW1fcHJlY2VkZW50WyJzdW0iXTsKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgJGF2ZXJhZ2UgPSAkc3VtX3ByZWNlZGVudFsiYXZlcmFn
ZSJdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAkcmF0aW5ncysrOwogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICRzdW0gKz0gJHBhZ2VbJ3BhdGgnXVsyXTsKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAkYXZlcmFnZSA9IHJvdW5kKCRzdW0gLyAkcmF0aW5ncywgMSk7CiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZWNobyAkYXZlcmFnZTsKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAvLyBOT1RFOiBzYWZlX3Vwc2VydCBkb2Vzbid0IHdv
cmsgaGVyZS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0eHBfdGNtX3Jz
dW0iLCAicGFyZW50X2lkPSciLiRwYWdlWydwYXRoJ11bMV0uIicsIHJhdGluZ3M9Ii4kcmF0
aW5ncy4iLCBzdW09Ii4kc3VtLiIsIGF2ZXJhZ2U9Ii4kYXZlcmFnZSwgInBhcmVudF9pZD0n
Ii4kcGFnZVsncGF0aCddWzFdLiInIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICRyID0gc2FmZV91cGRhdGUoInR4cF90Y21fcnN1bSIsICJyYXRpbmdzPSIgLiAkcmF0aW5n
cyAuICIsIHN1bT0iIC4gJHN1bSAuICIsIGF2ZXJhZ2U9IiAuICRhdmVyYWdlLCAicGFyZW50
X2lkPSciIC4gJHBhZ2VbJ3BhdGgnXVsxXSAuICInIik7CiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgaWYgKCRyIGFuZCBteXNxbF9hZmZlY3RlZF9yb3dzKCkpIHsKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNobyB0Y21fcmF0aW5nX2Zvcm0oQXJy
YXkoJ2ludGVybmFsJyA9PiB0cnVlLCAnaWQnID0+ICRhaWQpKTsKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgZXhpdDsKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaW5z
ID0gc2FmZV9pbnNlcnQoInR4cF90Y21fcnN1bSIsICJwYXJlbnRfaWQ9JyIgLiAkcGFnZVsn
cGF0aCddWzFdIC4gIicsIHJhdGluZ3M9IiAuICRyYXRpbmdzIC4gIiwgc3VtPSIgLiAkc3Vt
IC4gIiwgYXZlcmFnZT0iIC4gJGF2ZXJhZ2UpOwoKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgZWNobyB0Y21fcmF0aW5nX2Zvcm0oQXJyYXkoJ2ludGVybmFsJyA9PiB0
cnVlLCAnaWQnID0+ICRhaWQpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZXhpdDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGVjaG8gdGNtX3JhdGluZ19mb3JtKEFycmF5KCdpbnRlcm5hbCcgPT4gdHJ1ZSwgJ2lk
JyA9PiAkYWlkLCAnZXJyb3InID0+ICJZb3UndmUgYWxyZWFkeSByYXRlZCB0aGlzLiIpKTsK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGl0OwogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgZWNobyB0Y21fcmF0aW5nX2Zvcm0oQXJyYXkoJ2ludGVy
bmFsJyA9PiB0cnVlLCAnaWQnID0+ICRhaWQsICdlcnJvcicgPT4gIlNvcnJ5LCB0aGF0IGJp
dCBvZiBpbnB1dCBkaWRuJ3QgYWdyZWUgd2l0aCB0aGUgdGNtX3JhdGluZyBzeXN0ZW0uIikp
OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhpdDsKICAgICAgICAgICAgICAgICAg
ICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAg
ICAgICAgIGVjaG8gdGNtX3JhdGluZ19mb3JtKEFycmF5KCdpbnRlcm5hbCcgPT4gdHJ1ZSwg
J2lkJyA9PiAkYWlkLCAnZXJyb3InID0+ICJTb3JyeSwgeW91IG5lZWQgdG8gZW50ZXIgYSBu
dW1lcmljYWwgcmF0aW5nIGZvciB0aGUgYXJ0aWNsZSIpKTsKICAgICAgICAgICAgICAgICAg
ICAgICAgZXhpdDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVs
c2UgewogICAgICAgICAgICAgICAgICAgIC8vIE5PVEU6IGVycm9yOiBpbnZhbGlkIGFydGlj
bGUKICAgICAgICAgICAgICAgICAgICBlY2hvIHRjbV9yYXRpbmdfZm9ybShBcnJheSgnaW50
ZXJuYWwnID0+IHRydWUsICdpZCcgPT4gJGFpZCwgJ2Vycm9yJyA9PiAiU29ycnksIHRoYXQg
YXJ0aWNsZSBpcyBpbnZhbGlkLiIpKTsKICAgICAgICAgICAgICAgICAgICBleGl0OwogICAg
ICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8g
Tk9URTogZXJyb3I6IGludmFsaWQgSUQKICAgICAgICAgICAgICAgIGVjaG8gdGNtX3JhdGlu
Z19mb3JtKEFycmF5KCdpbnRlcm5hbCcgPT4gdHJ1ZSwgJ2Vycm9yJyA9PiAiU29ycnksIHRo
YXQgYXJ0aWNsZSBpcyBpbnZhbGlkLiIpKTsKICAgICAgICAgICAgICAgIGV4aXQ7CiAgICAg
ICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KLy8gVE9ETzogY3JlZGl0IGFqd19jbGVhbl9m
ZWVkX3JlcXVlc3QKZnVuY3Rpb24gdGNtX2NsZWFuX3JlcXVlc3QoKQp7CiAgICAkc3VicGF0
aCA9IHByZWdfcXVvdGUocHJlZ19yZXBsYWNlKCIvaHR0cDpcL1wvLiooXC8uKikvVWkiLCAi
JDEiLCBodSksICIvIik7CiAgICAkcmVxID0gcHJlZ19yZXBsYWNlKCIvXiRzdWJwYXRoL2ki
LCAiLyIsICRfU0VSVkVSWydSRVFVRVNUX1VSSSddKTsKICAgICRyZXEgPSBleHBsb2RlKCc/
JywgJHJlcSk7CiAgICByZXR1cm4gJHJlcTsKfQovLyBUT0RPOiBjcmVkaXQgYWp3X2NsZWFu
X2ZlZWRfY2hvcApmdW5jdGlvbiB0Y21fY2xlYW5fY2hvcCgkcmVxID0gJycpCnsKICAgICRy
ZXEgPSB1cmxkZWNvZGUoc3RydG9sb3dlcigkcmVxKSk7CiAgICAvLyBzdHJpcCBvZmYgcXVl
cnlfc3RyaW5nLCBpZiBwcmVzZW50CiAgICAkcXMgPSBzdHJwb3MoJHJlcSwgJz8nKTsKICAg
IGlmICgkcXMpICRyZXEgPSBzdWJzdHIoJHJlcSwgMCwgJHFzKTsKICAgICRyZXEgPSBwcmVn
X3JlcGxhY2UoJy9pbmRleFwucGhwJC8nLCAnJywgJHJlcSk7CiAgICAkcmVxID0gYXJyYXlf
dmFsdWVzKGFycmF5X2ZpbHRlcihleHBsb2RlKCcvJywgJHJlcSkpKTsKICAgIHJldHVybiAk
cmVxOwp9CgpmdW5jdGlvbiB0Y21fcmF0aW5nX2Zvcm0oJGF0dHMpCnsKICAgIGlmIChzYWZl
X3F1ZXJ5KCJkZXNjcmliZSAiIC4gUEZYIC4gInR4cF90Y21fcnF1ZXVlIikgJiYgc2FmZV9x
dWVyeSgiZGVzY3JpYmUgIiAuIFBGWCAuICJ0eHBfdGNtX3JzdW0iKSkgewogICAgICAgIGds
b2JhbCAkcHJldGV4dCwgJHRoaXNhcnRpY2xlOwogICAgICAgICRpZCA9IGdBdHQoJGF0dHMs
ICdpZCcsIGdwcygnaWQnKSk7CiAgICAgICAgZXh0cmFjdChsQXR0cyhhcnJheSgnZXJyb3In
ID0+ICcnLAogICAgICAgICAgICAgICAgICAgICdpbnRlcm5hbCcgPT4gZmFsc2UKICAgICAg
ICAgICAgICAgICAgICApLCAkYXR0cykpOwogICAgICAgIGlmIChAJHRoaXNhcnRpY2xlWyd0
aGlzaWQnXSkgJGlkID0gJHRoaXNhcnRpY2xlWyd0aGlzaWQnXTsKICAgICAgICBpZiAoISRp
ZCAmJiBAJHByZXRleHRbJ2lkJ10pICRpZCA9ICRwcmV0ZXh0WydpZCddOwogICAgICAgICRw
cmVjZWRlbnQgPSBzYWZlX3JvdygicmF0aW5ncywgYXZlcmFnZSIsICJ0eHBfdGNtX3JzdW0i
LCAicGFyZW50X2lkPSciIC4gJGlkIC4gIiciKTsKICAgICAgICBpZiAoIWVtcHR5KCRwcmVj
ZWRlbnQpKSB7CiAgICAgICAgICAgIC8vIHByaW50X3IoJHByZWNlZGVudCk7CiAgICAgICAg
ICAgICR3aWR0aCA9ICRwcmVjZWRlbnRbImF2ZXJhZ2UiXSAqIDI1OwogICAgICAgICAgICAk
YXZlcmFnZSA9ICRwcmVjZWRlbnRbImF2ZXJhZ2UiXTsKICAgICAgICAgICAgJGN1cnJlbnRf
cmF0aW5nID0gIjxsaSBjbGFzcz0nY3VycmVudC1yYXRpbmcnIHN0eWxlPSd3aWR0aDoiIC4g
JHdpZHRoIC4gInB4Oyc+Q3VycmVudGx5ICIgLiAkcHJlY2VkZW50WyJhdmVyYWdlIl0gLiAi
LzUgU3RhcnMuPC9saT4iOwogICAgICAgICAgICAkcmF0aW5nX2Rlc2MgPSAiPHNwYW4gY2xh
c3M9XCJyYXRpbmdkZXNjXCI+Q3VycmVudGx5ICRhdmVyYWdlLzUgU3RhcnMuPC9zcGFuPiI7
CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgJGN1cnJlbnRfcmF0aW5nID0gJGF2ZXJh
Z2UgPSAkd2lkdGggPSAkcmF0aW5nX2Rlc2MgPSAiIjsKICAgICAgICAgICAgJGVycm9yID0g
IlRoaXMgaGFzbid0IGJlZW4gcmF0ZWQgeWV0LiI7CiAgICAgICAgfQogICAgICAgIGlmICgh
ZW1wdHkoJGVycm9yKSkgewogICAgICAgICAgICAkZXJyb3JzcGFuID0gIjxzcGFuIGNsYXNz
PSdyYXRpbmdlcnJvcic+IiAuICRlcnJvciAuICI8L3NwYW4+IjsKICAgICAgICB9IGVsc2Ug
ewogICAgICAgICAgICAkZXJyb3JzcGFuID0gIiI7CiAgICAgICAgfQogICAgICAgIGlmICgh
JGludGVybmFsKSB7CiAgICAgICAgICAgICRkaXZfb3BlbiA9ICI8ZGl2IGlkPSd0Y21fcmF0
aW5nX2lucHV0Jz4iOwogICAgICAgICAgICAkZGl2X2Nsb3NlID0gIjwvZGl2PiI7CiAgICAg
ICAgfSBlbHNlIHsKICAgICAgICAgICAgJGRpdl9vcGVuID0gJGRpdl9jbG9zZSA9ICIiOwog
ICAgICAgIH0KICAgICAgICByZXR1cm4gPDw8IFJBVElOR0ZPUk0KJGRpdl9vcGVuCjx1bCBj
bGFzcz0ic3Rhci1yYXRpbmciPgokY3VycmVudF9yYXRpbmcKICA8bGk+PGEgaHJlZj0nIycg
dGl0bGU9J1JhdGUgdGhpcyAxIHN0YXIgb3V0IG9mIDUnIG9uY2xpY2s9J3RjbV9yYXRlKCRp
ZCwgMSwgdGhpcyk7JyBjbGFzcz0nb25lLXN0YXJzJz4xPC9hPjwvbGk+CiAgPGxpPjxhIGhy
ZWY9JyMnIHRpdGxlPSdSYXRlIHRoaXMgMiBzdGFycyBvdXQgb2YgNScgb25jbGljaz0ndGNt
X3JhdGUoJGlkLCAyLCB0aGlzKTsnIGNsYXNzPSd0d28tc3RhcnMnPjI8L2E+PC9saT4KICA8
bGk+PGEgaHJlZj0nIycgdGl0bGU9J1JhdGUgdGhpcyAzIHN0YXJzIG91dCBvZiA1JyBvbmNs
aWNrPSd0Y21fcmF0ZSgkaWQsIDMsIHRoaXMpOycgY2xhc3M9J3RocmVlLXN0YXJzJz4zPC9h
PjwvbGk+CiAgPGxpPjxhIGhyZWY9JyMnIHRpdGxlPSdSYXRlIHRoaXMgNCBzdGFycyBvdXQg
b2YgNScgb25jbGljaz0ndGNtX3JhdGUoJGlkLCA0LCB0aGlzKTsnIGNsYXNzPSdmb3VyLXN0
YXJzJz40PC9hPjwvbGk+CiAgPGxpPjxhIGhyZWY9JyMnIHRpdGxlPSdSYXRlIHRoaXMgNSBz
dGFycyBvdXQgb2YgNScgb25jbGljaz0ndGNtX3JhdGUoJGlkLCA1LCB0aGlzKTsnIGNsYXNz
PSdmaXZlLXN0YXJzJz41PC9hPjwvbGk+CjwvdWw+CiRyYXRpbmdfZGVzYwokZXJyb3JzcGFu
CiRkaXZfY2xvc2UKUkFUSU5HRk9STTsKICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuICI8
c3BhbiBjbGFzcz0ncmF0aW5nZXJyb3InPmVycm9yOiByYXRpbmcgZGF0YWJhc2UgZG9lc24n
dCBleGlzdC48L3NwYW4+IjsKICAgIH0KfQoKCmZ1bmN0aW9uIHRjbV9yYXRpbmdfbnVtKCRh
dHRzKQp7CiAgICBnbG9iYWwgJHRoaXNhcnRpY2xlOwogICAgZXh0cmFjdChsQXR0cyhhcnJh
eSgnbm9yYXRpbmdzJyA9PiAnVGhpcyBhcnRpY2xlIGhhc25cJ3QgYmVlbiByYXRlZCcsCiAg
ICAgICAgICAgICdoYXNiZWVuJyA9PiAnVGhpcyBoYXMgYmVlbiByYXRlZCAlciAodGltZS90
aW1lcyknLAogICAgICAgICAgICAnYWxwaGEnID0+IGZhbHNlCiAgICAgICAgICAgICksICRh
dHRzKSk7CiAgICAvLyBOT1RFOiBhdm9pZCBleHRyYSBzcWwgaWYgd2UgYXJlIGFscmVhZHkg
dXNpbmcgYSB0Y21fcmF0aW5nX2FydGljbGUgdGFnLgogICAgaWYgKGlzc2V0KCR0aGlzYXJ0
aWNsZVsicmF0aW5ncyJdKSkKICAgIHsKICAgICAgICAkcHJlY2VkZW50ID0gJHRoaXNhcnRp
Y2xlWyJyYXRpbmdzIl07CiAgICB9CiAgICBlbHNlaWYgKHNhZmVfcXVlcnkoImRlc2NyaWJl
ICIgLiBQRlggLiAidHhwX3RjbV9ycXVldWUiKSAmJiBzYWZlX3F1ZXJ5KCJkZXNjcmliZSAi
IC4gUEZYIC4gInR4cF90Y21fcnN1bSIpKSB7CiAgICAgICAgJGlkID0gZ0F0dCgkYXR0cywg
J2lkJywgZ3BzKCdpZCcpKTsKICAgICAgICBpZiAoQCR0aGlzYXJ0aWNsZVsndGhpc2lkJ10p
ICRpZCA9ICR0aGlzYXJ0aWNsZVsndGhpc2lkJ107CiAgICAgICAgaWYgKCEkaWQgJiYgQCRw
cmV0ZXh0WydpZCddKSAkaWQgPSAkcHJldGV4dFsnaWQnXTsKICAgICAgICAkcHJlY2VkZW50
ID0gc2FmZV9maWVsZCgicmF0aW5ncyIsICJ0eHBfdGNtX3JzdW0iLCAicGFyZW50X2lkPSci
IC4gJGlkIC4gIiciKTsKICAgIH0KICAgIGVsc2UgewogICAgICAgIHJldHVybiAiPHNwYW4g
Y2xhc3M9J3JhdGluZ2Vycm9yJz5lcnJvcjogcmF0aW5nIGRhdGFiYXNlIGRvZXNuJ3QgZXhp
c3QuPC9zcGFuPiI7CiAgICB9CiAgICAgICAgaWYgKCFlbXB0eSgkcHJlY2VkZW50KSkgewog
ICAgICAgICAgICBpZigkcHJlY2VkZW50ID4gMCkKICAgICAgICAgICAgewogICAgICAgICAg
ICAgICAgaWYoJHByZWNlZGVudCA9PSAxKQogICAgICAgICAgICAgICAgewogICAgICAgICAg
ICAgICAgICAgIC8vZWNobyAkaGFzYmVlbjsKICAgICAgICAgICAgICAgICAgICAkcmVnPSAn
I1woKFthLXpBLVowLTlfXSspLyhbYS16QS1aMC05X10rKVwpIyc7CiAgICAgICAgICAgICAg
ICAgICAgJHJlcD0gJyQxJzsKICAgICAgICAgICAgICAgICAgICAkcmVwbGFjZWQgPSBwcmVn
X3JlcGxhY2UoJHJlZywkcmVwLCRoYXNiZWVuKTsKICAgICAgICAgICAgICAgICAgICAkcmVw
bGFjZWQgPSAoJGFscGhhKSA/CiAgICAgICAgICAgICAgICAgICAgIHN0cl9yZXBsYWNlKCIl
ciIsIGludF90b193b3JkcyhpbnR2YWwoJHByZWNlZGVudCkpLCAkcmVwbGFjZWQpIDoKICAg
ICAgICAgICAgICAgICAgICAgc3RyX3JlcGxhY2UoIiVyIiwgaW50dmFsKCRwcmVjZWRlbnQp
LCAkcmVwbGFjZWQpOwogICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHJlcGxhY2VkOwog
ICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAg
ewogICAgICAgICAgICAgICAgICAgICRyZWc9ICcjXCgoW2EtekEtWjAtOV9dKykvKFthLXpB
LVowLTlfXSspXCkjJzsKICAgICAgICAgICAgICAgICAgICAkcmVwPSAnJDInOwogICAgICAg
ICAgICAgICAgICAgICRyZXBsYWNlZCA9IHByZWdfcmVwbGFjZSgkcmVnLCRyZXAsJGhhc2Jl
ZW4pOwogICAgICAgICAgICAgICAgICAgICRyZXBsYWNlZCA9ICgkYWxwaGEpID8KICAgICAg
ICAgICAgICAgICAgICAgc3RyX3JlcGxhY2UoIiVyIiwgaW50X3RvX3dvcmRzKGludHZhbCgk
cHJlY2VkZW50KSksICRyZXBsYWNlZCkgOgogICAgICAgICAgICAgICAgICAgICBzdHJfcmVw
bGFjZSgiJXIiLCBpbnR2YWwoJHByZWNlZGVudCksICRyZXBsYWNlZCk7CiAgICAgICAgICAg
ICAgICAgICAgIHJldHVybiAkcmVwbGFjZWQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg
ICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBlY2hvICRub3JhdGluZ3M7CiAg
ICAgICAgfQogICAgfQoKZnVuY3Rpb24gaW50X3RvX3dvcmRzKCR4KQp7CiAgICRud29yZHMg
PSBhcnJheSgiemVybyIsICJvbmUiLCAidHdvIiwgInRocmVlIiwgImZvdXIiLCAiZml2ZSIs
ICJzaXgiLCAic2V2ZW4iLAoJCQkJCSJlaWdodCIsICJuaW5lIiwgInRlbiIsICJlbGV2ZW4i
LCAidHdlbHZlIiwgInRoaXJ0ZWVuIiwKCQkJCQkiZm91cnRlZW4iLCAiZmlmdGVlbiIsICJz
aXh0ZWVuIiwgInNldmVudGVlbiIsICJlaWdodGVlbiIsCgkJCQkJIm5pbmV0ZWVuIiwgInR3
ZW50eSIsIDMwID0+ICJ0aGlydHkiLCA0MCA9PiAiZm9ydHkiLAoJCQkJCTUwID0+ICJmaWZ0
eSIsIDYwID0+ICJzaXh0eSIsIDcwID0+ICJzZXZlbnR5IiwgODAgPT4gImVpZ2h0eSIsCgkJ
CQkJOTAgPT4gIm5pbmV0eSIpOwoJaWYoIWlzX251bWVyaWMoJHgpKQoJewoJCSR3ID0gJyMn
OwoJfWVsc2UgaWYoZm1vZCgkeCwgMSkgIT0gMCkKCXsKCQkkdyA9ICcjJzsKCX1lbHNlewoJ
CWlmKCR4IDwgMCkKCQl7CgkJCSR3ID0gJ21pbnVzICc7CgkJCSR4ID0gLSR4OwoJCX1lbHNl
ewoJCQkkdyA9ICcnOwoJCX0KCQlpZigkeCA8IDIxKQoJCXsKCQkJJHcgLj0gJG53b3Jkc1sk
eF07CgkJfWVsc2UgaWYoJHggPCAxMDApCgkJewoJCQkkdyAuPSAkbndvcmRzWzEwICogZmxv
b3IoJHgvMTApXTsKCQkJJHIgPSBmbW9kKCR4LCAxMCk7CgkJCWlmKCRyID4gMCkKCQkJewoJ
CQkJJHcgLj0gJy0nLiAkbndvcmRzWyRyXTsKCQkJfQoJCX0gZWxzZSBpZigkeCA8IDEwMDAp
CgkJewoJCQkkdyAuPSAkbndvcmRzW2Zsb29yKCR4LzEwMCldIC4nIGh1bmRyZWQnOwoJCQkk
ciA9IGZtb2QoJHgsIDEwMCk7CgkJCWlmKCRyID4gMCkKCQkJewoJCQkJJHcgLj0gJyBhbmQg
Jy4gaW50X3RvX3dvcmRzKCRyKTsKCQkJfQoJCX0gZWxzZSBpZigkeCA8IDEwMDAwMDApCgkJ
ewoJCQkkdyAuPSBpbnRfdG9fd29yZHMoZmxvb3IoJHgvMTAwMCkpIC4nIHRob3VzYW5kJzsK
CQkJJHIgPSBmbW9kKCR4LCAxMDAwKTsKCQkJaWYoJHIgPiAwKQoJCQl7CgkJCQkkdyAuPSAn
ICc7CgkJCQlpZigkciA8IDEwMCkKCQkJCXsKCQkJCQkkdyAuPSAnYW5kICc7CgkJCQl9CgkJ
CQkkdyAuPSBpbnRfdG9fd29yZHMoJHIpOwoJCQl9CgkJfSBlbHNlIHsKCQkJJHcgLj0gaW50
X3RvX3dvcmRzKGZsb29yKCR4LzEwMDAwMDApKSAuJyBtaWxsaW9uJzsKCQkJJHIgPSBmbW9k
KCR4LCAxMDAwMDAwKTsKCQkJaWYoJHIgPiAwKQoJCQl7CgkJCQkkdyAuPSAnICc7CgkJCQlp
ZigkciA8IDEwMCkKCQkJCXsKCQkJCQkkd29yZCAuPSAnYW5kICc7CgkJCQl9CgkJCQkkdyAu
PSBpbnRfdG9fd29yZHMoJHIpOwoJCQl9CgkJfQoJfQoJcmV0dXJuICR3Owp9CgpmdW5jdGlv
biByZXR1cm5fanMoKQp7CiAgICRqcyA9IDw8PCBUSEVKUwoKIGZ1bmN0aW9uIGNyZWF0ZVhN
TEh0dHBSZXF1ZXN0KCkgewogICB0cnkgeyByZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoIk1z
eG1sMi5YTUxIVFRQIik7IH0gY2F0Y2ggKGUpIHt9CiAgIHRyeSB7IHJldHVybiBuZXcgQWN0
aXZlWE9iamVjdCgiTWljcm9zb2Z0LlhNTEhUVFAiKTsgfSBjYXRjaCAoZSkge30KICAgdHJ5
IHsgcmV0dXJuIG5ldyBYTUxIdHRwUmVxdWVzdCgpOyB9IGNhdGNoKGUpIHt9CiAgIGFsZXJ0
KCJYTUxIdHRwUmVxdWVzdCBub3Qgc3VwcG9ydGVkIik7CiAgIHJldHVybiBudWxsOwogfQog
ZnVuY3Rpb24gdGNtX3JhdGUoaWQsIHJhdGluZywgZWxlbWVudCkgewogICAgdmFyIHhoUmVx
ID0gY3JlYXRlWE1MSHR0cFJlcXVlc3QoKTsKICAgIHJlc3RVUkwgPSAiW0hVX1RFTVBdcmF0
ZS8iK2lkKyIvIityYXRpbmc7CiAgICAvL2FsZXJ0KHJlc3RVUkwpOwogICAgeGhSZXEub3Bl
bigiR0VUIiwgcmVzdFVSTCwgdHJ1ZSk7CiAgICB4aFJlcS5vbnJlYWR5c3RhdGVjaGFuZ2Ug
PSBmdW5jdGlvbigpIHsKICAgICAgaWYgKHhoUmVxLnJlYWR5U3RhdGUgIT0gNCkgIHsgcmV0
dXJuOyB9CiAgICAgIC8vcmF0aW5nX2lucHV0ID0gXCQoJ3RjbV9yYXRpbmdfaW5wdXQnKTsK
ICAgICAgb3V0ZXJkaXYgPSBlbGVtZW50LnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnRO
b2RlOwogICAgICB2YXIgc2VydmVyUmVzcG9uc2UgPSB4aFJlcS5yZXNwb25zZVRleHQ7CiAg
ICAgIG91dGVyZGl2LmlubmVySFRNTCA9IHNlcnZlclJlc3BvbnNlOwogICAgfTsKICAgIHho
UmVxLnNlbmQobnVsbCk7CiAgICByZXR1cm4gZmFsc2U7CiB9CgogZnVuY3Rpb24gXCQoKSB7
CiAgdmFyIGVsZW1lbnRzID0gbmV3IEFycmF5KCk7CgogIGZvciAodmFyIGkgPSAwOyBpIDwg
YXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgZWxlbWVudCA9IGFyZ3VtZW50c1tp
XTsKICAgIGlmICh0eXBlb2YgZWxlbWVudCA9PSAnc3RyaW5nJykKICAgICAgZWxlbWVudCA9
IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVsZW1lbnQpOwoKICAgIGlmIChhcmd1bWVudHMu
bGVuZ3RoID09IDEpCiAgICAgIHJldHVybiBlbGVtZW50OwoKICAgIGVsZW1lbnRzLnB1c2go
ZWxlbWVudCk7CiAgfQoKICByZXR1cm4gZWxlbWVudHM7Cn0KVEhFSlM7CgogICAgJGpzID0g
c3RyX3JlcGxhY2UoIltIVV9URU1QXSIsIGh1LCAkanMpOwogICAgcmV0dXJuICRqczsKfQoK
CmZ1bmN0aW9uIHJldHVybl9jc3MoJGltYWdlX3BhdGgpCnsKICAgICRjc3MgPSA8PDwgVEhF
Q1NTCgogICAgICAgICAJLyogICAgICAgICAgICAgc3R5bGVzIGZvciB0aGUgc3RhciByYXRl
ciAgICAgICAgICAgICAgICAqLwoJLnN0YXItcmF0aW5newoJCWxpc3Qtc3R5bGU6bm9uZTsK
CQltYXJnaW46IDBweDsKCQlwYWRkaW5nOjBweDsKCQl3aWR0aDogMTI1cHg7CgkJaGVpZ2h0
OiAyNXB4OwoJCXBvc2l0aW9uOiByZWxhdGl2ZTsKCQliYWNrZ3JvdW5kOiB1cmwoW0lNQUdF
X1BBVEhdKSB0b3AgbGVmdCByZXBlYXQteDsKCX0KCS5zdGFyLXJhdGluZyBsaXsKCQlwYWRk
aW5nOjBweDsKCQltYXJnaW46MHB4OwoJCS8qXCovCgkJZmxvYXQ6IGxlZnQ7CgkJLyogKi8K
CX0KCS5zdGFyLXJhdGluZyBsaSBhewpib3JkZXI6IDA7CgkJZGlzcGxheTpibG9jazsKCQl3
aWR0aDoyNXB4OwoJCWhlaWdodDogMjVweDsKCQl0ZXh0LWRlY29yYXRpb246IG5vbmU7CgkJ
dGV4dC1pbmRlbnQ6IC05MDAwcHg7CgkJei1pbmRleDogMjA7CgkJcG9zaXRpb246IGFic29s
dXRlOwoJCXBhZGRpbmc6IDBweDsKCX0KCS5zdGFyLXJhdGluZyBsaSBhOmhvdmVyewoJCWJh
Y2tncm91bmQ6IHVybChbSU1BR0VfUEFUSF0pIGxlZnQgYm90dG9tOwoJCXotaW5kZXg6IDI7
CgkJbGVmdDogMHB4OwoJfQoJLnN0YXItcmF0aW5nIGEub25lLXN0YXJ7CgkJbGVmdDogMHB4
OwoJfQoJLnN0YXItcmF0aW5nIGEub25lLXN0YXI6aG92ZXJ7CgkJd2lkdGg6MjVweDsKCX0K
CS5zdGFyLXJhdGluZyBhLnR3by1zdGFyc3sKCQlsZWZ0OjI1cHg7Cgl9Cgkuc3Rhci1yYXRp
bmcgYS50d28tc3RhcnM6aG92ZXJ7CgkJd2lkdGg6IDUwcHg7Cgl9Cgkuc3Rhci1yYXRpbmcg
YS50aHJlZS1zdGFyc3sKCQlsZWZ0OiA1MHB4OwoJfQoJLnN0YXItcmF0aW5nIGEudGhyZWUt
c3RhcnM6aG92ZXJ7CgkJd2lkdGg6IDc1cHg7Cgl9Cgkuc3Rhci1yYXRpbmcgYS5mb3VyLXN0
YXJzewoJCWxlZnQ6IDc1cHg7Cgl9Cgkuc3Rhci1yYXRpbmcgYS5mb3VyLXN0YXJzOmhvdmVy
ewoJCXdpZHRoOiAxMDBweDsKCX0KCS5zdGFyLXJhdGluZyBhLmZpdmUtc3RhcnN7CgkJbGVm
dDogMTAwcHg7Cgl9Cgkuc3Rhci1yYXRpbmcgYS5maXZlLXN0YXJzOmhvdmVyewoJCXdpZHRo
OiAxMjVweDsKCX0KCS5zdGFyLXJhdGluZyBsaS5jdXJyZW50LXJhdGluZ3sKCQliYWNrZ3Jv
dW5kOiB1cmwoW0lNQUdFX1BBVEhdKSBsZWZ0IGNlbnRlcjsKCQlwb3NpdGlvbjogYWJzb2x1
dGU7CgkJaGVpZ2h0OiAyNXB4OwoJCWRpc3BsYXk6IGJsb2NrOwoJCXRleHQtaW5kZW50OiAt
OTAwMHB4OwoJCXotaW5kZXg6IDE7Cgl9Ci5yYXRpbmdlcnJvciB7CmNvbG9yOiByZWQ7Cn0K
VEhFQ1NTOwogICAgJGNzcyA9IHN0cl9yZXBsYWNlKCJbSU1BR0VfUEFUSF0iLCAkaW1hZ2Vf
cGF0aCwgJGNzcyk7CiAgICByZXR1cm4gJGNzczsKfQoKZnVuY3Rpb24gdGNtX3JhdGluZ19q
c190YWcoKQp7CiAgIHJldHVybiAiPHNjcmlwdCB0eXBlPVwidGV4dC9qYXZhc2NyaXB0XCIg
c3JjPVwiIi5odS4icmF0aW5nanNcIj48L3NjcmlwdD4iOwp9CgoKLy8gLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoJZnVu
Y3Rpb24gdGNtX3JhdGluZ19hcnRpY2xlcygkYXR0cywgJGlzY3VzdG9tKQoJewoJCWdsb2Jh
bCAkcHJldGV4dCwgJHByZWZzLCAkdHhwY2ZnOwogICAgICAgIGlmIChzYWZlX3F1ZXJ5KCJk
ZXNjcmliZSAiIC4gUEZYIC4gInR4cF90Y21fcnF1ZXVlIikgJiYgc2FmZV9xdWVyeSgiZGVz
Y3JpYmUgIiAuIFBGWCAuICJ0eHBfdGNtX3JzdW0iKSkgewoJCWV4dHJhY3QoJHByZXRleHQp
OwoJCWV4dHJhY3QoJHByZWZzKTsKCQkvL2dldHRpbmcgYXR0cmlidXRlcwoJCSR0aGVBdHRz
ID0gbEF0dHMoYXJyYXkoCgkJCSdmb3JtJyAgICAgID0+ICdkZWZhdWx0JywKCQkJJ2xpbWl0
JyAgICAgPT4gMTAsCgkJCSdwYWdlYnknICAgID0+ICcnLAoJCQknY2F0ZWdvcnknICA9PiAn
JywKCQkJJ3NlY3Rpb24nICAgPT4gJycsCgkJCSdleGNlcnB0ZWQnID0+ICcnLAoJCQknYXV0
aG9yJyAgICA9PiAnJywKCQkJJ3NvcnRieScgICAgPT4gJycsCgkJCSdzb3J0ZGlyJyAgID0+
ICdkZXNjJywKCQkJJ21vbnRoJyAgICAgPT4gJycsCgkJCSdrZXl3b3JkcycgID0+ICcnLAoJ
CQknZnJvbnRwYWdlJyA9PiAnJywKCQkJJ2lkJyAgICAgICAgPT4gJycsCgkJCSd0aW1lJyAg
ICAgID0+ICdwYXN0JywKCQkJJ3N0YXR1cycgICAgPT4gJzQnLAoJCQkncGdvbmx5JyAgICA9
PiAwLAoJCQknc2VhcmNoYWxsJyA9PiAxLAoJCQknc2VhcmNoc3RpY2t5JyA9PiAwLAoJCQkn
YWxsb3dvdmVycmlkZScgPT4gKCEkcSBhbmQgISRpc2N1c3RvbSksCgkJCSdvZmZzZXQnICAg
ID0+IDAsCgkJKSwkYXR0cyk7CgoJCS8vIGlmIGFuIGFydGljbGUgSUQgaXMgc3BlY2lmaWVk
LCB0cmVhdCBpdCBhcyBhIGN1c3RvbSBsaXN0CgkJJGlzY3VzdG9tID0gKCFlbXB0eSgkdGhl
QXR0c1snaWQnXSkpID8gdHJ1ZSA6ICRpc2N1c3RvbTsKCgkJLy9mb3IgdGhlIHR4cDphcnRp
Y2xlIHRhZywgc29tZSBhdHRyaWJ1dGVzIGFyZSB0YWtlbiBmcm9tIGdsb2JhbHM7CgkJLy9v
dmVycmlkZSB0aGVtIGJlZm9yZSBleHRyYWN0CgoJCWlmICghJGlzY3VzdG9tKQoJCXsKCQkJ
Ly8kdGhlQXR0c1snY2F0ZWdvcnknXSA9ICgkYyk/ICRjIDogJyc7CgkJCS8vJHRoZUF0dHNb
J3NlY3Rpb24nXSA9ICgkcyAmJiAkcyE9J2RlZmF1bHQnKT8gJHMgOiAnJzsKCQkJJHRoZUF0
dHNbJ2F1dGhvciddID0gKCFlbXB0eSgkYXV0aG9yKT8gJGF1dGhvcjogJycpOwoJCQkkdGhl
QXR0c1snbW9udGgnXSA9ICghZW1wdHkoJG1vbnRoKT8gJG1vbnRoOiAnJyk7CgkJCS8vJHRo
ZUF0dHNbJ2Zyb250cGFnZSddID0gKCRzICYmICRzPT0nZGVmYXVsdCcpPyB0cnVlOiBmYWxz
ZTsKCQkJLy8kdGhlQXR0c1snZXhjZXJwdGVkJ10gPSAnJzsKCQl9CgkJZXh0cmFjdCgkdGhl
QXR0cyk7CgoJCSRwYWdlYnkgPSAoZW1wdHkoJHBhZ2VieSkgPyAkbGltaXQgOiAkcGFnZWJ5
KTsKCgkJLy8gdHJlYXQgc3RpY2t5IGFydGljbGVzIGRpZmZlcmVudGx5IHdydCBzZWFyY2gg
ZmlsdGVyaW5nLCBldGMKCQlpZiAoIWlzX251bWVyaWMoJHN0YXR1cykpCgkJCSRzdGF0dXMg
PSBnZXRTdGF0dXNOdW0oJHN0YXR1cyk7CgkJJGlzc3RpY2t5ID0gKCRzdGF0dXMgPT0gNSk7
CgoJCSRtYXRjaCA9ICRzZWFyY2ggPSAnJzsKICAgICAgICBpZiAoISRzb3J0YnkpICRzb3J0
Ynk9IFBGWC4ndHhwX3RjbV9yc3VtLmF2ZXJhZ2UnOwoKCQkvL0J1aWxkaW5nIHF1ZXJ5IHBh
cnRzCgkJJGZyb250cGFnZSA9ICgkZnJvbnRwYWdlIGFuZCAhJHEpID8gZmlsdGVyRnJvbnRQ
YWdlKCkgOiAnJzsKCQkkY2F0ZWdvcnkgID0gKCEkY2F0ZWdvcnkpICA/ICcnIDogIiBhbmQg
KChDYXRlZ29yeTE9JyIuZG9zbGFzaCgkY2F0ZWdvcnkpLiInKSBvciAoQ2F0ZWdvcnkyPSci
LmRvU2xhc2goJGNhdGVnb3J5KS4iJykpICI7CgkJJHNlY3Rpb24gICA9ICghJHNlY3Rpb24p
ICAgPyAnJyA6ICIgYW5kIFNlY3Rpb24gPSAnIi5kb3NsYXNoKCRzZWN0aW9uKS4iJyI7CgkJ
JGV4Y2VycHRlZCA9ICgkZXhjZXJwdGVkPT0neScpICA/ICIgYW5kIEV4Y2VycHQgIT0nJyIg
OiAnJzsKCQkkYXV0aG9yICAgID0gKCEkYXV0aG9yKSAgICA/ICcnIDogIiBhbmQgQXV0aG9y
SUQgPSAnIi5kb3NsYXNoKCRhdXRob3IpLiInIjsKCQkkbW9udGggICAgID0gKCEkbW9udGgp
ICAgICA/ICcnIDogIiBhbmQgUG9zdGVkIGxpa2UgJyIuZG9TbGFzaCgkbW9udGgpLiIlJyI7
CgkJJGlkICAgICAgICA9ICghJGlkKSAgICAgICAgPyAnJyA6ICIgYW5kIElEID0gJyIuaW50
dmFsKCRpZCkuIiciOwoJCXN3aXRjaCAoJHRpbWUpIHsKCQkJY2FzZSAnYW55JzoKCQkJCSR0
aW1lID0gIiI7IGJyZWFrOwoJCQljYXNlICdmdXR1cmUnOgoJCQkJJHRpbWUgPSAiIGFuZCBQ
b3N0ZWQgPiBub3coKSI7IGJyZWFrOwoJCQlkZWZhdWx0OgoJCQkJJHRpbWUgPSAiIGFuZCBQ
b3N0ZWQgPCBub3coKSI7CgkJfQoJCWlmICghaXNfbnVtZXJpYygkc3RhdHVzKSkKCQkJJHN0
YXR1cyA9IGdldFN0YXR1c051bSgkc3RhdHVzKTsKCgkJJGN1c3RvbSA9ICcnOwoKCQkvLyB0
cnlpbmcgY3VzdG9tIGZpZWxkcyBoZXJlCgkJJGN1c3RvbUZpZWxkcyA9IGdldEN1c3RvbUZp
ZWxkcygpOwoKCQlpZiAoJGN1c3RvbUZpZWxkcykgewoJCQlmb3JlYWNoKCRjdXN0b21GaWVs
ZHMgYXMgJGNGaWVsZCkgewoJCQkJaWYgKGlzc2V0KCRhdHRzWyRjRmllbGRdKSkKCQkJCQkk
Y3VzdG9tUGFpcnNbJGNGaWVsZF0gPSAkYXR0c1skY0ZpZWxkXTsKCQkJfQoJCQlpZighZW1w
dHkoJGN1c3RvbVBhaXJzKSkgewoJCQkJJGN1c3RvbSA9ICBidWlsZEN1c3RvbVNxbCgkY3Vz
dG9tRmllbGRzLCRjdXN0b21QYWlycyk7CgkJCX0gZWxzZSAkY3VzdG9tID0gJyc7CgkJfQoK
CQkvL0FsbG93IGtleXdvcmRzIGZvciBuby1jdXN0b20gYXJ0aWNsZXMuIFRoYXQgdGFnZ2lu
ZyBtb2RlLCB5b3Uga25vdwoJCWlmICgka2V5d29yZHMpIHsKCQkJJGtleXMgPSBzcGxpdCgn
LCcsJGtleXdvcmRzKTsKCQkJZm9yZWFjaCAoJGtleXMgYXMgJGtleSkgewoJCQkJJGtleXBh
cnRzW10gPSAiIEtleXdvcmRzIGxpa2UgJyUiLmRvU2xhc2godHJpbSgka2V5KSkuIiUnIjsK
CQkJfQoJCQkka2V5d29yZHMgPSAiIGFuZCAoIiAuIGpvaW4oJyBvciAnLCRrZXlwYXJ0cykg
LiAiKSI7CgkJfQoKCQlpZiAoJHEgYW5kICRzZWFyY2hzdGlja3kpCgkJCSRzdGF0dXNxID0g
IiBhbmQgU3RhdHVzID49ICc0JyI7CgkJZWxzZWlmICgkaWQpCgkJCSRzdGF0dXNxID0gIiBh
bmQgU3RhdHVzID49ICc0JyI7CgkJZWxzZQoJCQkkc3RhdHVzcSA9ICIgYW5kIFN0YXR1cz0n
Ii5kb1NsYXNoKCRzdGF0dXMpLiInIjsKCgkJJHdoZXJlID0gIjEiIC4gJHN0YXR1c3EuICR0
aW1lLgoJCQkkc2VhcmNoIC4gJGlkIC4gJGNhdGVnb3J5IC4gJHNlY3Rpb24gLiAkZXhjZXJw
dGVkIC4gJG1vbnRoIC4gJGF1dGhvciAuICRrZXl3b3JkcyAuICRjdXN0b20gLiAkZnJvbnRw
YWdlOwoKCQkvL2RvIG5vdCBwYWdpbmF0ZSBpZiB3ZSBhcmUgb24gYSBjdXN0b20gbGlzdAoJ
CWlmICghJGlzY3VzdG9tIGFuZCAhJGlzc3RpY2t5KQoJCXsKCQkJJHRvdGFsID0gc2FmZV9j
b3VudCgndGV4dHBhdHRlcm4nLCR3aGVyZSkgLSAkb2Zmc2V0OwoJCQkkbnVtUGFnZXMgPSBj
ZWlsKCR0b3RhbC8kcGFnZWJ5KTsKCQkJJHBnID0gKCEkcGcpID8gMSA6ICRwZzsKCQkJJHBn
b2Zmc2V0ID0gJG9mZnNldCArICgoJHBnIC0gMSkgKiAkcGFnZWJ5KS4nLCAnOwoJCQkvLyBz
ZW5kIHBhZ2luZyBpbmZvIHRvIHR4cDpuZXdlciBhbmQgdHhwOm9sZGVyCgkJCSRwYWdlb3V0
WydwZyddICAgICAgID0gJHBnOwoJCQkkcGFnZW91dFsnbnVtUGFnZXMnXSA9ICRudW1QYWdl
czsKCQkJJHBhZ2VvdXRbJ3MnXSAgICAgICAgPSAkczsKCQkJJHBhZ2VvdXRbJ2MnXSAgICAg
ICAgPSAkYzsKCQkJJHBhZ2VvdXRbJ3RvdGFsJ10gICAgPSAkdG90YWw7CgoJCQlnbG9iYWwg
JHRoaXNwYWdlOwoJCQkkdGhpc3BhZ2UgPSAkcGFnZW91dDsKCQkJaWYgKCRwZ29ubHkpCgkJ
CQlyZXR1cm47CgkJfWVsc2V7CgkJCSRwZ29mZnNldCA9ICRvZmZzZXQgLiAnLCAnOwoJCX0K
ICAgICAgICAkd2hlcmUgLj0gIiBhbmQgIi5QRlguInR4cF90Y21fcnN1bS5wYXJlbnRfaWQg
PSAiLlBGWC4idGV4dHBhdHRlcm4uSUQiOwoJCSRycyA9IHNhZmVfcm93c19zdGFydF9qb2lu
ZWQoIiosIHR4cF90Y21fcnN1bS5yYXRpbmdzLCB0eHBfdGNtX3JzdW0uYXZlcmFnZSwgdW5p
eF90aW1lc3RhbXAoUG9zdGVkKSBhcyB1UG9zdGVkIi4kbWF0Y2gsIEFycmF5KCd0ZXh0cGF0
dGVybicsICd0eHBfdGNtX3JzdW0nKSwKCQkkd2hlcmUuICcgb3JkZXIgYnkgJyAuIGRvc2xh
c2goJHNvcnRieSkgLiAnICcgLiBkb1NsYXNoKCRzb3J0ZGlyKSAuICcgbGltaXQgJyAuIGRv
U2xhc2goJHBnb2Zmc2V0LiRsaW1pdCkpOwoJCS8vIGFsdGVybmF0aXZlIGZvcm0gb3ZlcnJp
ZGUgZm9yIHNlYXJjaCBvciBsaXN0CgkJaWYgKCRxIGFuZCAhJGlzY3VzdG9tIGFuZCAhJGlz
c3RpY2t5KQoJCQkkZm9ybSA9IGdBdHQoJGF0dHMsICdzZWFyY2hmb3JtJywgJ3NlYXJjaF9y
ZXN1bHRzJyk7CgkJZWxzZQoJCQkkZm9ybSA9IGdBdHQoJGF0dHMsICdsaXN0Zm9ybScsICRm
b3JtKTsKCQkvLyBtaWdodCBiZSBhIGZvcm0gcHJldmlldywgb3RoZXJ3aXNlIGdyYWIgaXQg
ZnJvbSB0aGUgZGIKCQkkZm9ybSA9IChpc3NldCgkX1BPU1RbJ0Zvcm0nXSkpCgkJPwlncHMo
J0Zvcm0nKQoJCToJZmV0Y2hfZm9ybSgkZm9ybSk7CgoJCWlmICgkcnMpIHsKCQkJJGNvdW50
ID0gMDsKCgkJCSRhcnRpY2xlcyA9IGFycmF5KCk7CgkJCXdoaWxlKCRhID0gbmV4dFJvdygk
cnMpKSB7CgkJCQkrKyRjb3VudDsKCQkJCXBvcHVsYXRlQXJ0aWNsZURhdGFSYXRpbmdzKCRh
KTsKCQkJCWdsb2JhbCAkdGhpc2FydGljbGUsICR1UG9zdGVkLCAkbGltaXQ7CgkJCQkkdGhp
c2FydGljbGVbJ2lzX2ZpcnN0J10gPSAoJGNvdW50ID09IDEpOwoJCQkJJHRoaXNhcnRpY2xl
Wydpc19sYXN0J10gPSAoJGNvdW50ID09IG51bVJvd3MoJHJzKSk7CgkJCQkvLyBkZWZpbmUg
dGhlIGFydGljbGUgZm9ybQoJCQkJJGFydGljbGUgPSAoJGFsbG93b3ZlcnJpZGUgYW5kICRh
WydvdmVycmlkZV9mb3JtJ10pCgkJCQk/CWZldGNoX2Zvcm0oJGFbJ292ZXJyaWRlX2Zvcm0n
XSkKCQkJCToJJGZvcm07CgoJCQkJJGFydGljbGVzW10gPSBwYXJzZSgkYXJ0aWNsZSk7CgoJ
CQkJLy8gc2VuZGluZyB0aGVzZSB0byBwYWdpbmdfbGluaygpOyBSZXF1aXJlZD8KCQkJCSR1
UG9zdGVkID0gJGFbJ3VQb3N0ZWQnXTsKCQkJCSRsaW1pdCA9ICRsaW1pdDsKCgkJCQl1bnNl
dCgkR0xPQkFMU1sndGhpc2FydGljbGUnXSk7CgkJCQl1bnNldCgkR0xPQkFMU1sndGhlc2Vh
dHRzJ10pOy8vUmVxdWlyZWQ/CgkJCX0KCgkJCXJldHVybiBqb2luKCcnLCRhcnRpY2xlcyk7
CgkJfQogICAgICAgIH0KCX0KICAgIGZ1bmN0aW9uIHNhZmVfcm93c19zdGFydF9qb2luZWQo
JHRoaW5ncywgJHRhYmxlcywgJHdoZXJlLCAkZGVidWc9JycpCgl7CiAgICAgICAgYXJyYXlf
d2FsaygkdGFibGVzLCAndGFibGVfc2xhc2gnKTsKICAgICAgICAkdGFibGUgPSBqb2luKCIs
IiwgJHRhYmxlcyk7CgkJJHEgPSAic2VsZWN0ICR0aGluZ3MgZnJvbSAkdGFibGUgd2hlcmUg
JHdoZXJlIjsKCQlyZXR1cm4gc3RhcnRSb3dzKCRxLCRkZWJ1Zyk7Cgl9CiAgICBmdW5jdGlv
biB0YWJsZV9zbGFzaCgmJGl0ZW0xLCAka2V5KQogICAgewogICAgICAgJGl0ZW0xID0gImAi
LlBGWC4kaXRlbTEuImAiOwogICAgfQoKICAgIGZ1bmN0aW9uIHBvcHVsYXRlQXJ0aWNsZURh
dGFSYXRpbmdzKCRycykKCXsKICAgICAgICAvL3ByaW50X3IoJHJzKTsKCQlleHRyYWN0KCRy
cyk7CgoJCXRyYWNlX2FkZCgiWyIuZ1R4dCgnQXJ0aWNsZScpLiIgJElEXSIpOwoJCSRvdXRb
J3RoaXNpZCddICAgICAgICAgID0gJElEOwoJCSRvdXRbJ3Bvc3RlZCddICAgICAgICAgID0g
JHVQb3N0ZWQ7CgkJJG91dFsnYW5ub3RhdGUnXSAgICAgICAgPSAkQW5ub3RhdGU7CgkJJG91
dFsnY29tbWVudHNfaW52aXRlJ10gPSAkQW5ub3RhdGVJbnZpdGU7CgkJJG91dFsnYXV0aG9y
aWQnXSAgICAgICAgPSAkQXV0aG9ySUQ7CgkJJG91dFsndGl0bGUnXSAgICAgICAgICAgPSAk
VGl0bGU7CgkJJG91dFsndXJsX3RpdGxlJ10gICAgICAgPSAkdXJsX3RpdGxlOwoJCSRvdXRb
J2NhdGVnb3J5MSddICAgICAgID0gJENhdGVnb3J5MTsKCQkkb3V0WydyYXRpbmdzJ10gICAg
ICAgPSAkcmF0aW5nczsKCQkkb3V0WydhdmVyYWdlJ10gICAgICAgPSAkYXZlcmFnZTsKCQkk
b3V0WydjYXRlZ29yeTInXSAgICAgICA9ICRDYXRlZ29yeTI7CgkJJG91dFsnc2VjdGlvbidd
ICAgICAgICAgPSAkU2VjdGlvbjsKCQkkb3V0WydrZXl3b3JkcyddICAgICAgICA9ICRLZXl3
b3JkczsKCQkkb3V0WydhcnRpY2xlX2ltYWdlJ10gICA9ICRJbWFnZTsKCQkkb3V0Wydjb21t
ZW50c19jb3VudCddICA9ICRjb21tZW50c19jb3VudDsKCgoJCSRjdXN0b20gPSBnZXRDdXN0
b21GaWVsZHMoKTsKCQlpZiAoJGN1c3RvbSkgewoJCQlmb3JlYWNoICgkY3VzdG9tIGFzICRp
ID0+ICRuYW1lKQoJCQkJJG91dFskbmFtZV0gPSAkcnNbJ2N1c3RvbV8nIC4gJGldOwoJCX0K
CgkJZ2xvYmFsICR0aGlzYXJ0aWNsZSwgJGlzX2FydGljbGVfYm9keTsKCQkkdGhpc2FydGlj
bGUgPSAkb3V0OwoJCSRpc19hcnRpY2xlX2JvZHkgPSAxOwoJCSR0aGlzYXJ0aWNsZVsnYm9k
eSddID0gcGFyc2UoJEJvZHlfaHRtbCk7CgkJJHRoaXNhcnRpY2xlWydleGNlcnB0J10gPSBw
YXJzZSgkRXhjZXJwdF9odG1sKTsKCQkkaXNfYXJ0aWNsZV9ib2R5ID0gMDsKCgl9CiI7czoz
OiJtZDUiO3M6MzI6ImI5ZTg5MzE2YzAyY2UzMWExMzM2NTIyNGM1NjAwNmM3Ijt9

